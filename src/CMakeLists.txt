add_subdirectory(benchmarks)
add_executable(hwperfvar main.c worker.c barrier.c)
set_source_files_properties(main.c PROPERTIES COMPILE_DEFINITIONS _GNU_SOURCE) # for asprintf
target_link_libraries(hwperfvar benchmark ${HWLOC_LIBRARIES} ${CMAKE_THREAD_LIBS_INIT})
if(HAVE_LIBRT)
  target_link_libraries(hwperfvar ${LIBRT_LIBRARIES})
endif()
if(JEVENTS_FOUND)
  target_include_directories(hwperfvar PRIVATE ${JEVENTS_INCDIR})
  target_link_libraries(hwperfvar ${JEVENTS_LIBRARIES})
endif()
